{% extends 'base.html' %}
{% block content %}

<div class="card">
  <h2>출석 · Attendance By Date</h2>
  <p class="helper">Attendance by Date.</p>
</div>

{% for day in days %}
  <section class="card" style="text-align:left; max-width:800px;">
    <h3 style="margin-top:0;">
      {{ day.session.class_date.strftime('%A, %b %d, %Y') }}
    </h3>

    {% if day.count == 0 %}
      <p class="helper">No check-ins recorded.</p>
    {% else %}
      <ul style="list-style:disc; padding-left:24px; margin-top:8px;">
        {% for s in day.students %}
          <li>{{ s.name }} <span class="helper">({{ s.email }})</span></li>
        {% endfor %}
      </ul>
      <p style="font-weight:bold; margin-top:12px;">
        Total Present: {{ day.count }}
      </p>
    {% endif %}

    <!-- Optional per-date CSV export -->
    <form method="get" action="{{ url_for('export_csv') }}" style="margin-top:8px;">
      <input type="hidden" name="session_id" value="{{ day.session.id }}">
      <button type="submit">⬇️ Export CSV for this date</button>
    </form>
  </section>
{% endfor %}

{% endblock %}
